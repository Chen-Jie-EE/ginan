# ex11 - PPP Ionosphere-Free Observable Example
# Uses IGS orbit and clock products to produce kinematic PPP solition (GPS-only, float ambiguities)
# Total processing duration  ~ 1.2 minutes on 2-cores

inputs:

    root_directory: products/

    atx_files: [ igs14_2045_plus.atx ]  # Antenna models for receivers and satellites in ANTEX format
    snx_files: [ igs19P2062.snx, tables/igs_satellite_metadata_2203_plus.snx ]  # SINEX file for meta data and initial position
    blq_files: [ OLOAD_GO.BLQ        ]  # ocean loading is applied

    troposphere:
        vmf_files:          [grid5/VMF3_20190718.H00, grid5/VMF3_20190718.H06, grid5/VMF3_20190718.H12, grid5/VMF3_20190718.H18]
        orography_files:  orography_ell_5x5
        # gpt2grid_files: gpt_25.grd
    
    egm_files:  [ tables/EGM2008.gfc         ]  # Earth gravity model coefficients file
    jpl_files:  [ tables/DE436.1950.2050     ]  # JPL planetary and lunar ephemerides file
    tide_files: [ tables/fes2014b_Cnm-Snm.dat]
    
    satellite_data:
        #nav_files: [ brdm1990.19p        ]  # broadcast navigation file
        sp3_files: [ igs20624.sp3        ]  # satellite orbit files in SP3 format
        clk_files: [ igs20624.clk_30s    ]  # Clk files
        bsx_files: [ TUG0R03FIN_20191990000_01D_01D_OSB.BIA ] # daily signal biases files
        
        #rtcm_inputs:
    gnss_observations:
        inputs_root: data/
        
        ubx_inputs:
            #- serial:///dev/ttyACM0
        rtcm_inputs:
            #- https://<USER>:<PASS>@ntrip.data.gnss.ga.gov.au/ALIC00AUS0
        rnx_inputs:
            - "ALIC*.rnx"
            #- "ANKO*.rnx"

station_options:
    XMPL:  
        #apriori_position: [120000,20000,40000]
        #eccentricity:      [1, 2, 3]
        #antenna_type:      LEICA
        #receiver_type:     UBLOX
            
outputs:

    root_directory:             <CONFIG>/

    trace:
        output_stations:        true
        output_network:         true
        level:                  4
        directory:              ./
        station_filename:               <CONFIG>-<STATION><YYYY><DDD><HH>.TRACE
        output_residuals:       true

    sinex:
        output:                 true
        directory:              ./
    
    clocks:                 
        output:                 true
        
    trop_sinex:
        #output:                 true
        sources:                [KALMAN]

    cost:
        #output:                     true
        sources:                    [KALMAN]
        directory:                  ./
        filename:                   cost_s_t_<STATION>_ga__.dat
        time_interval:              300
        
    gpx:  
        #output:                 true
        
    orbex:
        #output:                 true

    metadata:
        config_description:     ex11
        analysis_agency:        GAA
        analysis_center:        Geoscience Australia
        analysis_program:       AUSACS
        rinex_comment:          AUSNETWORK1
    
    ppp_sol:
        output:                 true
        filename:               <STATION><YYYY><DDD><HH>_<CONFIG>.POS

mongo:
    enable:                     true
    output_measurements:        true
    output_states:              true
    output_test_stats:          true
    delete_history:             true
    uri:                        mongodb://127.0.0.1:27017
    #suffix:                     


debug:
    #unit_tests:
        #stop_on_done:   true
        #output_pass:    false

station_options:
    
    global:
        rnx_code_conversions:
            gps:
                C1:     L1C
                C2:     L2S
                P2:     L2W
                C5:     L5Q
        rnx_phase_conversions:
            gps:
                L2:     L2W
                L5:     L5Q
                L1:     L1C
    
    AGGO:
        rnx_code_conversions:
            gps:
               C5:      L5I
        rnx_phase_conversions:
            gps:
               L5:      L5I

    COCO:
        rnx_code_conversions:
            gps:
               C5:      L5I
        rnx_phase_conversions:
            gps:
               L5:      L5I

processing_options:

    epoch_control:
        #start_epoch:                2019-07-18 23:44:30
        #end_epoch:                  2019-07-18 23:59:30
        epoch_interval:             30          #seconds
        #max_epochs:                 1        #0 is infinite

    process_modes:
        #ppp:                   true
        user:                   true

    gnss_general:

        #require_apriori_positions: true
        
        elevation_mask:     7   #degrees
    
        raim:               true

        max_gdop:   30
        sys_options:
            bds:
                #process:    true
            gps:
                process:    true
                reject_eclipse: true
                code_priorities: [  L1C, L1P, L1Y, L1W, L1M, L1N, L1S, L1L,
                                    L2W, L2P, L2Y, L2C, L2M, L2N, L2D, L2S, L2L, L2X,
                                    L5I, L5Q, L5X]
    
    gnss_models:
            
        tides:
            #solid:         false
            #pole:          false
            #otl:           false
        troposphere:
            model:          vmf3    #gpt2
        sat_pos:
            #sources:        [broadcast]
        sat_clock:
            #sources:        [broadcast]
        sat_attitude:
            sources:        [model]
            
    #reinit_on_all_slips:       true
    #reinit_on_clock_error:     true
    #deweight_on_state_error:   true



    filter_options:

        outlier_screening:
            max_filter_iterations:      5 #5
            max_prefit_removals:        3 #5
            
        station_chunking: 
            #enable:                 true

        rts:
            enable:                 true
            lag:                    -1      #-ve for full reverse, +ve for limited epochs
            directory:              ./
            suffix:                 _smoothed

        inverter:                   LDLT         #LLT LDLT INV


estimation_parameters:

    stations:

        error_model:        elevation_dependent         #uniform elevation_dependent
        code_sigmas:        [0.15]
        phase_sigmas:       [0.0015]

        pos:
            estimated:          [true]
            sigma:              [100]
            proc_noise:         [100]
            proc_noise_dt:      second

        clk:
            estimated:          [true]
            sigma:              [30]
            proc_noise:         [10]
            proc_noise_dt:      second

        clk_rate:
            #estimated:          [true]
            sigma:              [500]
            proc_noise:         [1e-4]
            proc_noise_dt:      second

        amb:
            estimated:          [true]
            sigma:              [60]
            proc_noise:         [0]
            #proc_noise_dt:      day

        trop:
            estimated:          [true]
            sigma:              [0.1]
            proc_noise:         [0.0001] #0.1 mm/sqrt(s)
            proc_noise_dt:      second

        trop_grads:
            estimated:          [true]
            sigma:              [0.005]
            proc_noise:         [1.0E-6]
            proc_noise_dt:      second
